import pandas as pd
import dataiku

# Clé de votre projet Dataiku
project_key = "API_DATAIKU"

# Nom de votre dataset
dataset_name = "test"

# Obtenir le dataset
dataset = dataiku.Dataset(project_key, dataset_name)

# Charger les données actuelles du dataset dans un DataFrame
current_data = dataset.read_dataframe()

# Ajouter une nouvelle ligne (remplacez les valeurs par celles de la nouvelle ligne)
new_row = {
    "Nom": "NouveauNom",
    "Prenom": "NouveauPrenom",
    "Age": 28
}

# Ajouter la nouvelle ligne au DataFrame
current_data = current_data.append(new_row, ignore_index=True)

# Réécrire les données mises à jour dans le dataset
dataset.write_with_schema(current_data)
